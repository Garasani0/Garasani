using UnityEngine;
using UnityEngine.UI;
using TMPro; // TextMeshPro?? ???????? ???? ????
using System.Collections;

public class DoubleClickToggleButton : MonoBehaviour
{
    public Button button; // UI ??
    public Image buttonImage; // ?? ??? ????
    public Sprite newSprite; // ??? ?? ???? ? ??? ???
    private Sprite originalSprite; // ??? ?? ???
    private int clickCount = 0; // ?? ??? ??
    private float clickTime = 0; // ? ?? ??? ??? ??
    private float clickDelay = 0.5f; // ?? ?? ?? (0.5?)
    private bool isOriginal = true; // ?? ?? ???? ?? ????? ??

    public TextMeshProUGUI itemNameText; // UI?? ??? ??? ??? TextMeshProUGUI ??
    public TextMeshProUGUI itemInfoText; // UI?? ??? ??? ??? TextMeshProUGUI ??
    public TextMeshProUGUI itemName; // ?? ??? ???? ??? ???? TextMeshProUGUI ??
    public TextMeshProUGUI itemInfo; // ?? ??? ???? ??? ???? TextMeshProUGUI ??

    public GameObject[] item_quantity; // ?? ???? ??, ?????? ??? ??? ???? ? ?? ??



    void Start()
    {
        button.onClick.AddListener(OnButtonClick);
        originalSprite = buttonImage.sprite; // ?? ?? ???? ??
        for(int i = 0; i < 12; i++)
        {
            item_quantity[i].SetActive(false); //?? ui ??? 
        }
    }


    void OnButtonClick()
    {
        clickCount++;
        if (clickCount == 1)
        {
            clickTime = Time.time;
        }
        else if (clickCount == 2 && Time.time - clickTime < clickDelay)
        {
            if (isOriginal)
            {
                buttonImage.sprite = newSprite; // ?? ???? ??
                Debug.Log("???? ???????.");
            }
            else
            {
                buttonImage.sprite = originalSprite; // ?? ???? ???
                Debug.Log("???? ?? ???? ???????.");
            }
            isOriginal = !isOriginal; // ??? ??? ??
            clickCount = 0;

            // ??? ?? ????
            UpdateItemInfo();
        }
        else
        {
            clickCount = 0;
        }
    }


    void Update()
    {
        if (clickCount == 1 && Time.time - clickTime >= clickDelay)
        {
            clickCount = 0; // ?? ?? ??? ???? ?? ??? ???
        }
    }


    void UpdateItemInfo()
    {
        itemNameText.text = itemName.text;
        itemInfoText.text = itemInfo.text;
        Debug.Log($"??? ??: {itemName}, ??? ??: {itemInfo}");
    }


    public void UpdateQuantity(int quantity) //?? ???? 
    {

        item_quantity[quantity - 1].SetActive(true); //?? ???? ui ?? 
        if (quantity != 1) //?? 1? ?? ?? ??? ?? 
        {
            item_quantity[quantity - 2].SetActive(false); //?? ?? ui? ?? 
        }
        Debug.Log($"??? ??? ?????????: {quantity}");
    }

}
